{"version":3,"sources":["webparts/bingTranslator/BingTranslatorWebPart.ts"],"names":[],"mappings":"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","file":"webparts/bingTranslator/BingTranslatorWebPart.js","sourcesContent":["/**\r\n * @file\r\n * Bing Translator Web Part for SharePoint Framework SPFx\r\n *\r\n * Author: Olivier Carpentier\r\n * Copyright (c) 2016\r\n */\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneDropdown,\r\n  IWebPartContext\r\n} from '@microsoft/sp-webpart-base';\r\nimport { Version } from '@microsoft/sp-core-library';\r\n\r\nimport * as strings from 'BingTranslatorStrings';\r\nimport { IBingTranslatorWebPartProps } from './IBingTranslatorWebPartProps';\r\nimport { SPComponentLoader } from '@microsoft/sp-loader';\r\n\r\n//Imports property pane custom fields\r\nimport { PropertyFieldColorPicker } from 'sp-client-custom-fields/lib/PropertyFieldColorPicker';\r\n\r\nexport default class BingTranslatorWebPart extends BaseClientSideWebPart<IBingTranslatorWebPartProps> {\r\n\r\n  private guid: string;\r\n\r\n  /**\r\n   * @function\r\n   * Web part contructor.\r\n   */\r\n  public constructor(context?: IWebPartContext) {\r\n    super();\r\n\r\n    this.guid = this.getGuid();\r\n\r\n    //Hack: to invoke correctly the onPropertyChange function outside this class\r\n    //we need to bind this object on it first\r\n    this.onPropertyPaneFieldChanged = this.onPropertyPaneFieldChanged.bind(this);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Gets WP data version\r\n   */\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Renders HTML code\r\n   */\r\n  public render(): void {\r\n\r\n    //Define the main DIV container\r\n    var html = `\r\n    <div id='MicrosoftTranslatorWidget' class='${this.properties.theme}' style='color:${this.properties.color};background-color:${this.properties.backgroundColor}'></div>\r\n    `;\r\n    this.domElement.innerHTML = html;\r\n    //Loads the microsoft translator JavaScript from CDN\r\n    SPComponentLoader.loadScript('//www.microsofttranslator.com/ajax/v3/WidgetV3.ashx?siteData=ueOIGRSKkd965FeEGM5JtQ**&ctf=False&ui=true&settings=' + this.properties.start + '&from=' + this.properties.language, { globalExportsName: 'bingtranslator' }).then((): void => {\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID\r\n   */\r\n  private getGuid(): string {\r\n    return this.s4() + this.s4() + '-' + this.s4() + '-' + this.s4() + '-' +\r\n      this.s4() + '-' + this.s4() + this.s4() + this.s4();\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * Generates a GUID part\r\n   */\r\n  private s4(): string {\r\n      return Math.floor((1 + Math.random()) * 0x10000)\r\n        .toString(16)\r\n        .substring(1);\r\n  }\r\n\r\n  /**\r\n   * @function\r\n   * PropertyPanel settings definition\r\n   */\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          displayGroupsAsAccordion: false,\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneDropdown('theme', {\r\n                  label: strings.theme,\r\n                  options: [\r\n                    {key: 'Dark', text: 'Dark'},\r\n                    {key: 'Light', text: 'Light'}\r\n                  ]\r\n                }),\r\n                PropertyPaneDropdown('start', {\r\n                  label: strings.start,\r\n                  options: [\r\n                    {key: 'Manual', text: 'Manual'},\r\n                    {key: 'Auto', text: 'Auto'}\r\n                  ]\r\n                }),\r\n                PropertyPaneDropdown('language', {\r\n                  label: strings.language,\r\n                  options: [\r\n                    {key: '', text: 'Auto Detect'},\r\n                    {key: 'af', text: 'Afrikaans'},\r\n                    {key: 'ar', text: 'Arabic'},\r\n                    {key: 'bs-Latn', text: 'Bosnian (latin)'},\r\n                    {key: 'bg', text: 'Bulgarian'},\r\n                    {key: 'ca', text: 'Catalan'},\r\n                    {key: 'zh-CHS', text: 'Simplified Chinese'},\r\n                    {key: 'zh-CHT', text: 'Traditional Chinese'},\r\n                    {key: 'yue', text: 'Cantonese (traditional)'},\r\n                    {key: 'hr', text: 'Croatian'},\r\n                    {key: 'cs', text: 'Czech'},\r\n                    {key: 'da', text: 'Danish'},\r\n                    {key: 'nl', text: 'Dutch'},\r\n                    {key: 'en', text: 'English'},\r\n                    {key: 'et', text: 'Estonian'},\r\n                    {key: 'fj', text: 'Fijian'},\r\n                    {key: 'fil', text: 'Filipino'},\r\n                    {key: 'fi', text: 'Finnish'},\r\n                    {key: 'fr', text: 'French'},\r\n                    {key: 'de', text: 'German'},\r\n                    {key: 'el', text: 'Greek'},\r\n                    {key: 'ht', text: 'Haitian'},\r\n                    {key: 'he', text: 'Hebrew'},\r\n                    {key: 'hi', text: 'Hindi'},\r\n                    {key: 'mww', text: 'Hmong daw'},\r\n                    {key: 'hu', text: 'Hungarian'},\r\n                    {key: 'id', text: 'Indonesian'},\r\n                    {key: 'it', text: 'Italian'},\r\n                    {key: 'ja', text: 'Japanese'},\r\n                    {key: 'sw', text: 'Swahili'},\r\n                    {key: 'tlh', text: 'Klingon'},\r\n                    {key: 'ko', text: 'Korean'},\r\n                    {key: 'lv', text: 'Latvian'},\r\n                    {key: 'lt', text: 'Lithuanian'},\r\n                    {key: 'mg', text: 'Malagasy'},\r\n                    {key: 'ms', text: 'Malay'},\r\n                    {key: 'mt', text: 'Maltese'},\r\n                    {key: 'yua', text: 'Yucatec Maya'},\r\n                    {key: 'no', text: 'Norvegian'},\r\n                    {key: 'otq', text: 'Quer√©taro Otomi'},\r\n                    {key: 'fa', text: 'Perse '},\r\n                    {key: 'pl', text: 'Polish'},\r\n                    {key: 'pt', text: 'Portuguese'},\r\n                    {key: 'ro', text: 'Romanian'},\r\n                    {key: 'ru', text: 'Russian'},\r\n                    {key: 'sm', text: 'Samoan'},\r\n                    {key: 'sr-Cyrl', text: 'Serbian (Cyrillic)'},\r\n                    {key: 'sr-Latn', text: 'Serbian (latin)'},\r\n                    {key: 'sk', text: 'Slovak'},\r\n                    {key: 'sl', text: 'Slovenian'},\r\n                    {key: 'es', text: 'Spanish'},\r\n                    {key: 'sv', text: 'Swedish'},\r\n                    {key: 'ty', text: 'Tahitian'},\r\n                    {key: 'th', text: 'Thai'},\r\n                    {key: 'to', text: 'Tongan'},\r\n                    {key: 'tr', text: 'Turkish'},\r\n                    {key: 'uk', text: 'Ukrainian'},\r\n                    {key: 'ur', text: 'Urdu'},\r\n                    {key: 'vi', text: 'Vietnamese'},\r\n                    {key: 'cy', text: 'Welsh'}\r\n                  ]\r\n                }),\r\n                PropertyFieldColorPicker('color', {\r\n                  label: strings.color,\r\n                  initialColor: this.properties.color,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: \"bingTranslatorColorField\"\r\n                }),\r\n                PropertyFieldColorPicker('backgroundColor', {\r\n                  label: strings.backgroundColor,\r\n                  initialColor: this.properties.backgroundColor,\r\n                  onPropertyChange: this.onPropertyPaneFieldChanged,\r\n                  render: this.render.bind(this),\r\n                  disableReactivePropertyChanges: this.disableReactivePropertyChanges,\r\n                  properties: this.properties,\r\n                  key: \"bingTranslatorBgColorField\"\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}